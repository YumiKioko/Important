<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WPSCAN Complete Walkthrough</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Courier New', monospace;
            line-height: 1.6;
            background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%);
            color: #e0e0e0;
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            text-align: center;
            margin-bottom: 40px;
            padding: 30px;
            background: linear-gradient(45deg, #000000, #333333);
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
            border: 1px solid #444;
        }

        h1 {
            font-size: 3em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.8);
            letter-spacing: 3px;
            background: linear-gradient(45deg, #ffffff, #cccccc);
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .subtitle {
            font-size: 1.2em;
            color: #aaa;
            font-weight: 300;
            letter-spacing: 1px;
        }

        .nav-menu {
            background: #1e1e1e;
            padding: 15px;
            margin: 20px 0;
            border-radius: 10px;
            border: 1px solid #333;
            box-shadow: inset 0 2px 5px rgba(0,0,0,0.3);
        }

        .nav-menu ul {
            list-style: none;
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 20px;
        }

        .nav-menu a {
            color: #ccc;
            text-decoration: none;
            padding: 8px 16px;
            border: 1px solid #444;
            border-radius: 5px;
            transition: all 0.3s ease;
            background: #2a2a2a;
        }

        .nav-menu a:hover {
            background: #444;
            color: #fff;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
        }

        .section {
            margin: 40px 0;
            background: #252525;
            padding: 30px;
            border-radius: 12px;
            border: 1px solid #333;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }

        h2 {
            color: #fff;
            margin-bottom: 20px;
            font-size: 2em;
            border-bottom: 2px solid #444;
            padding-bottom: 10px;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
        }

        h3 {
            color: #ddd;
            margin: 25px 0 15px 0;
            font-size: 1.4em;
            border-left: 4px solid #666;
            padding-left: 15px;
        }

        .code-block {
            background: #1a1a1a;
            border: 1px solid #333;
            border-radius: 8px;
            padding: 20px;
            margin: 15px 0;
            overflow-x: auto;
            font-family: 'Courier New', monospace;
            box-shadow: inset 0 2px 5px rgba(0,0,0,0.3);
        }

        .code-block pre {
            margin: 0;
            color: #00ff00;
            text-shadow: 0 0 5px rgba(0,255,0,0.3);
        }

        .command {
            color: #00ffff;
            font-weight: bold;
        }

        .output {
            color: #ffff00;
            margin-top: 10px;
        }

        .warning {
            background: #2a1a1a;
            border-left: 4px solid #ff4444;
            padding: 15px;
            margin: 20px 0;
            border-radius: 5px;
        }

        .info {
            background: #1a1a2a;
            border-left: 4px solid #4444ff;
            padding: 15px;
            margin: 20px 0;
            border-radius: 5px;
        }

        .success {
            background: #1a2a1a;
            border-left: 4px solid #44ff44;
            padding: 15px;
            margin: 20px 0;
            border-radius: 5px;
        }

        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .feature-card {
            background: #1e1e1e;
            padding: 20px;
            border-radius: 8px;
            border: 1px solid #333;
            transition: transform 0.3s ease;
        }

        .feature-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.4);
        }

        .option-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: #1e1e1e;
        }

        .option-table th,
        .option-table td {
            border: 1px solid #333;
            padding: 12px;
            text-align: left;
        }

        .option-table th {
            background: #2a2a2a;
            color: #fff;
            font-weight: bold;
        }

        .option-table tr:nth-child(even) {
            background: #222;
        }

        .btn {
            display: inline-block;
            padding: 10px 20px;
            background: #333;
            color: #fff;
            text-decoration: none;
            border-radius: 5px;
            border: 1px solid #444;
            transition: all 0.3s ease;
            margin: 5px;
        }

        .btn:hover {
            background: #444;
            transform: translateY(-2px);
        }

        .terminal {
            background: #000;
            color: #00ff00;
            padding: 20px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            margin: 15px 0;
            border: 2px solid #333;
            box-shadow: 0 0 20px rgba(0,255,0,0.1);
        }

        .terminal::before {
            content: "terminal@wpscan:~$ ";
            color: #00ffff;
            font-weight: bold;
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            h1 {
                font-size: 2em;
            }
            
            .nav-menu ul {
                flex-direction: column;
            }
            
            .feature-grid {
                grid-template-columns: 1fr;
            }
        }

        .scroll-top {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: #333;
            color: #fff;
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            cursor: pointer;
            display: none;
            z-index: 1000;
        }

        .toc {
            background: #1e1e1e;
            padding: 20px;
            border-radius: 10px;
            border: 1px solid #333;
            margin: 20px 0;
        }

        .toc ul {
            list-style: none;
            padding-left: 0;
        }

        .toc li {
            padding: 5px 0;
            border-bottom: 1px solid #333;
        }

        .toc a {
            color: #ccc;
            text-decoration: none;
        }

        .toc a:hover {
            color: #fff;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>WPSCAN</h1>
            <p class="subtitle">Complete WordPress Security Scanner Walkthrough</p>
        </header>

        <div class="toc">
            <h3>Table of Contents</h3>
            <ul>
                <li><a href="#introduction">Introduction</a></li>
                <li><a href="#installation">Installation</a></li>
                <li><a href="#basic-usage">Basic Usage</a></li>
                <li><a href="#advanced-options">Advanced Options</a></li>
                <li><a href="#enumeration">Enumeration Techniques</a></li>
                <li><a href="#vulnerability-scanning">Vulnerability Scanning</a></li>
                <li><a href="#brute-force">Brute Force Attacks</a></li>
                <li><a href="#output-formats">Output Formats</a></li>
                <li><a href="#api-integration">API Integration</a></li>
                <li><a href="#troubleshooting">Troubleshooting</a></li>
                <li><a href="#best-practices">Best Practices</a></li>
            </ul>
        </div>

        <section id="introduction" class="section">
            <h2>Introduction to WPSCAN</h2>
            <p>WPSCAN is a free, open-source WordPress security scanner written in Ruby. It's designed to identify security vulnerabilities in WordPress installations, including:</p>
            
            <div class="feature-grid">
                <div class="feature-card">
                    <h3>Core Vulnerabilities</h3>
                    <p>Scans WordPress core files for known security issues and outdated versions.</p>
                </div>
                <div class="feature-card">
                    <h3>Plugin & Theme Scanning</h3>
                    <p>Identifies vulnerable plugins and themes with comprehensive database checks.</p>
                </div>
                <div class="feature-card">
                    <h3>User Enumeration</h3>
                    <p>Discovers usernames and performs brute force attacks on authentication.</p>
                </div>
                <div class="feature-card">
                    <h3>Configuration Issues</h3>
                    <p>Detects misconfigurations and security weaknesses in WordPress setup.</p>
                </div>
            </div>

            <div class="warning">
                <strong>⚠️ Legal Warning:</strong> Only use WPSCAN on websites you own or have explicit permission to test. Unauthorized scanning may violate terms of service and local laws.
            </div>
        </section>

        <section id="installation" class="section">
            <h2>Installation Guide</h2>

            <h3>System Requirements</h3>
            <ul>
                <li>Ruby 2.7 or higher</li>
                <li>RubyGems package manager</li>
                <li>Internet connection for vulnerability database updates</li>
            </ul>

            <h3>Installation Methods</h3>

            <h4>Method 1: Gem Installation (Recommended)</h4>
            <div class="code-block">
                <pre><span class="command">gem install wpscan</span></pre>
            </div>

            <h4>Method 2: Docker Installation</h4>
            <div class="code-block">
                <pre><span class="command">docker pull wpscanteam/wpscan</span>
<span class="command">docker run -it --rm wpscanteam/wpscan --url https://example.com</span></pre>
            </div>

            <h4>Method 3: From Source</h4>
            <div class="code-block">
                <pre><span class="command">git clone https://github.com/wpscanteam/wpscan.git</span>
<span class="command">cd wpscan</span>
<span class="command">bundle install</span>
<span class="command">ruby wpscan.rb --url https://example.com</span></pre>
            </div>

            <h4>Method 4: Kali Linux (Pre-installed)</h4>
            <div class="code-block">
                <pre><span class="command">wpscan --update</span>
<span class="command">wpscan --url https://example.com</span></pre>
            </div>

            <div class="success">
                <strong>✅ Verification:</strong> Run <code>wpscan --version</code> to confirm installation.
            </div>
        </section>

        <section id="basic-usage" class="section">
            <h2>Basic Usage</h2>

            <h3>Simple Scan</h3>
            <div class="terminal">wpscan --url https://target-website.com</div>

            <h3>Scan with User Enumeration</h3>
            <div class="terminal">wpscan --url https://target-website.com --enumerate u</div>

            <h3>Comprehensive Scan</h3>
            <div class="terminal">wpscan --url https://target-website.com --enumerate ap,at,cb,dbe</div>

            <h3>Understanding Basic Output</h3>
            <div class="code-block">
                <pre><span class="output">[+] URL: https://example.com/
[+] Started: Thu Aug 17 10:30:00 2025

[+] WordPress version 6.2.2 identified (Latest, released on 2023-05-20).

[+] WordPress theme in use: twentytwentythree
 | Location: https://example.com/wp-content/themes/twentytwentythree/
 | Last Updated: 2023-05-10T00:00:00.000Z
 | [!] The version is out of date, the latest version is 1.2

[+] Enumerating All Plugins (via Passive Methods)
[i] No plugins found.

[+] Finished: Thu Aug 17 10:32:15 2025
[+] Requests Done: 125
[+] Cached Requests: 0
[+] Data Sent: 29.156 KB
[+] Data Received: 142.534 KB
[+] Memory used: 85.156 MB
[+] Elapsed time: 00:02:15</span></pre>
            </div>
        </section>

        <section id="advanced-options" class="section">
            <h2>Advanced Options</h2>

            <h3>Core Command Line Options</h3>
            <table class="option-table">
                <thead>
                    <tr>
                        <th>Option</th>
                        <th>Description</th>
                        <th>Example</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>--url</td>
                        <td>Target URL to scan</td>
                        <td>--url https://example.com</td>
                    </tr>
                    <tr>
                        <td>--enumerate</td>
                        <td>Enumeration mode</td>
                        <td>--enumerate u,p,t</td>
                    </tr>
                    <tr>
                        <td>--threads</td>
                        <td>Number of threads (1-50)</td>
                        <td>--threads 20</td>
                    </tr>
                    <tr>
                        <td>--throttle</td>
                        <td>Milliseconds between requests</td>
                        <td>--throttle 1000</td>
                    </tr>
                    <tr>
                        <td>--random-user-agent</td>
                        <td>Use random user agents</td>
                        <td>--random-user-agent</td>
                    </tr>
                    <tr>
                        <td>--force</td>
                        <td>Force scan non-WordPress sites</td>
                        <td>--force</td>
                    </tr>
                </tbody>
            </table>

            <h3>Authentication Options</h3>
            <div class="code-block">
                <pre><span class="command"># HTTP Basic Authentication</span>
<span class="command">wpscan --url https://example.com --http-auth username:password</span>

<span class="command"># Cookie-based Authentication</span>
<span class="command">wpscan --url https://example.com --cookie "session=abc123"</span>

<span class="command"># Custom Headers</span>
<span class="command">wpscan --url https://example.com --headers "Authorization: Bearer token123"</span></pre>
            </div>

            <h3>Proxy and Network Options</h3>
            <div class="code-block">
                <pre><span class="command"># Using Proxy</span>
<span class="command">wpscan --url https://example.com --proxy http://127.0.0.1:8080</span>

<span class="command"># SOCKS Proxy</span>
<span class="command">wpscan --url https://example.com --proxy socks5://127.0.0.1:1080</span>

<span class="command"># Custom Timeout</span>
<span class="command">wpscan --url https://example.com --request-timeout 60</span>

<span class="command"># Disable SSL Verification</span>
<span class="command">wpscan --url https://example.com --disable-tls-checks</span></pre>
            </div>
        </section>

        <section id="enumeration" class="section">
            <h2>Enumeration Techniques</h2>

            <h3>Enumeration Modes</h3>
            <table class="option-table">
                <thead>
                    <tr>
                        <th>Mode</th>
                        <th>Description</th>
                        <th>Command</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>u</td>
                        <td>Users</td>
                        <td>--enumerate u</td>
                    </tr>
                    <tr>
                        <td>ap</td>
                        <td>All Plugins</td>
                        <td>--enumerate ap</td>
                    </tr>
                    <tr>
                        <td>p</td>
                        <td>Popular Plugins</td>
                        <td>--enumerate p</td>
                    </tr>
                    <tr>
                        <td>vp</td>
                        <td>Vulnerable Plugins</td>
                        <td>--enumerate vp</td>
                    </tr>
                    <tr>
                        <td>at</td>
                        <td>All Themes</td>
                        <td>--enumerate at</td>
                    </tr>
                    <tr>
                        <td>t</td>
                        <td>Popular Themes</td>
                        <td>--enumerate t</td>
                    </tr>
                    <tr>
                        <td>vt</td>
                        <td>Vulnerable Themes</td>
                        <td>--enumerate vt</td>
                    </tr>
                    <tr>
                        <td>cb</td>
                        <td>Config Backups</td>
                        <td>--enumerate cb</td>
                    </tr>
                    <tr>
                        <td>dbe</td>
                        <td>Database Exports</td>
                        <td>--enumerate dbe</td>
                    </tr>
                </tbody>
            </table>

            <h3>User Enumeration Examples</h3>
            <div class="code-block">
                <pre><span class="command"># Basic user enumeration</span>
<span class="command">wpscan --url https://example.com --enumerate u</span>

<span class="command"># Enumerate users with ID range</span>
<span class="command">wpscan --url https://example.com --enumerate u1-100</span>

<span class="command"># Enumerate users from author archives</span>
<span class="command">wpscan --url https://example.com --enumerate u --detection-mode aggressive</span></pre>
            </div>

            <div class="code-block">
                <pre><span class="output">[+] Enumerating Users (via Passive and Aggressive Methods)
 Brute Forcing Author IDs - Time: 00:00:02 <==> (10 / 10) 100.00% Time: 00:00:02

[i] User(s) Identified:

[+] admin
 | Found By: Author Posts - Display Name (Passive Detection)
 | Confirmed By:
 |  Rss Generator (Passive Detection)
 |  Author Id Brute Forcing - Author Pattern (Aggressive Detection)

[+] john.doe
 | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection)
 | Confirmed By: Login Error Messages (Aggressive Detection)</span></pre>
            </div>

            <h3>Plugin and Theme Enumeration</h3>
            <div class="code-block">
                <pre><span class="command"># Enumerate all plugins (aggressive)</span>
<span class="command">wpscan --url https://example.com --enumerate ap --detection-mode aggressive</span>

<span class="command"># Enumerate vulnerable plugins only</span>
<span class="command">wpscan --url https://example.com --enumerate vp</span>

<span class="command"># Enumerate themes with version detection</span>
<span class="command">wpscan --url https://example.com --enumerate at --plugins-version-all</span></pre>
            </div>
        </section>

        <section id="vulnerability-scanning" class="section">
            <h2>Vulnerability Scanning</h2>

            <h3>WordPress Vulnerability Database</h3>
            <div class="info">
                <strong>ℹ️ Info:</strong> WPSCAN uses the WPVulnDB (WordPress Vulnerability Database) to identify known security issues. Register for a free API token to access the full database.
            </div>

            <h3>API Token Registration</h3>
            <div class="code-block">
                <pre><span class="command"># Register at https://wpscan.com/register</span>
<span class="command"># Add token to scan</span>
<span class="command">wpscan --url https://example.com --api-token YOUR_API_TOKEN</span>

<span class="command"># Save token globally</span>
<span class="command">wpscan --url https://example.com --api-token YOUR_TOKEN --save-api-token</span></pre>
            </div>

            <h3>Vulnerability Detection Examples</h3>
            <div class="code-block">
                <pre><span class="command"># Full vulnerability scan</span>
<span class="command">wpscan --url https://example.com --api-token YOUR_TOKEN --enumerate ap,at,u</span>

<span class="command"># Only scan for vulnerable components</span>
<span class="command">wpscan --url https://example.com --api-token YOUR_TOKEN --enumerate vp,vt</span>

<span class="command"># Include main theme in vulnerability check</span>
<span class="command">wpscan --url https://example.com --api-token YOUR_TOKEN --enumerate at --plugins-detection aggressive</span></pre>
            </div>

            <div class="code-block">
                <pre><span class="output">[+] contact-form-7
 | Location: https://example.com/wp-content/plugins/contact-form-7/
 | Last Updated: 2023-07-15T12:34:00.000Z
 | [!] The version is out of date, the latest version is 5.7.8
 | [!] 2 vulnerabilities identified:
 |
 | [!] Title: Contact Form 7 < 5.7.6 - Stored Cross-Site Scripting
 |     Fixed in: 5.7.6
 |     References:
 |      - https://wpscan.com/vulnerability/12345678-1234-1234-1234-123456789012
 |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-12345
 |
 | [!] Title: Contact Form 7 < 5.7.7 - Missing Authorization
 |     Fixed in: 5.7.7
 |     References:
 |      - https://wpscan.com/vulnerability/87654321-4321-4321-4321-210987654321</span></pre>
            </div>
        </section>

        <section id="brute-force" class="section">
            <h2>Brute Force Attacks</h2>

            <div class="warning">
                <strong>⚠️ Warning:</strong> Brute force attacks can be detected by security plugins and may result in IP blocking. Use responsibly and only on authorized targets.
            </div>

            <h3>Password Attacks</h3>
            <div class="code-block">
                <pre><span class="command"># Basic brute force with wordlist</span>
<span class="command">wpscan --url https://example.com --usernames admin --passwords /path/to/wordlist.txt</span>

<span class="command"># Multiple users</span>
<span class="command">wpscan --url https://example.com --usernames admin,user1,editor --passwords passwords.txt</span>

<span class="command"># User and password from files</span>
<span class="command">wpscan --url https://example.com --usernames users.txt --passwords passwords.txt</span></pre>
            </div>

            <h3>Advanced Brute Force Options</h3>
            <div class="code-block">
                <pre><span class="command"># Limit login attempts</span>
<span class="command">wpscan --url https://example.com --usernames admin --passwords passwords.txt --max-threads 5</span>

<span class="command"># Add delay between attempts</span>
<span class="command">wpscan --url https://example.com --usernames admin --passwords passwords.txt --throttle 2000</span>

<span class="command"># Multicall method (faster but detectable)</span>
<span class="command">wpscan --url https://example.com --usernames admin --passwords passwords.txt --multicall-max-passwords 100</span></pre>
            </div>

            <h3>Common Password Lists</h3>
            <div class="feature-grid">
                <div class="feature-card">
                    <h4>SecLists</h4>
                    <p>/usr/share/seclists/Passwords/Common-Credentials/10-million-password-list-top-1000000.txt</p>
                </div>
                <div class="feature-card">
                    <h4>RockYou</h4>
                    <p>/usr/share/wordlists/rockyou.txt</p>
                </div>
                <div class="feature-card">
                    <h4>Custom WordPress</h4>
                    <p>/usr/share/wpscan/passwords.txt</p>
                </div>
            </div>

            <h3>XML-RPC Brute Force</h3>
            <div class="code-block">
                <pre><span class="command"># Test if XML-RPC is enabled</span>
<span class="command">wpscan --url https://example.com --enumerate m</span>

<span class="command"># XML-RPC brute force (if available)</span>
<span class="command">wpscan --url https://example.com --usernames admin --passwords passwords.txt --multicall</span></pre>
            </div>
        </section>

        <section id="output-formats" class="section">
            <h2>Output Formats and Reporting</h2>

            <h3>Output Formats</h3>
            <div class="code-block">
                <pre><span class="command"># JSON output</span>
<span class="command">wpscan --url https://example.com --format json --output results.json</span>

<span class="command"># CLI output with colors disabled</span>
<span class="command">wpscan --url https://example.com --format cli-no-color --output results.txt</span>

<span class="command"># CLI output with minimal info</span>
<span class="command">wpscan --url https://example.com --format cli-no-banner --output results.txt</span></pre>
            </div>

            <h3>Verbose and Debug Output</h3>
            <div class="code-block">
                <pre><span class="command"># Verbose output</span>
<span class="command">wpscan --url https://example.com --verbose</span>

<span class="command"># Debug mode</span>
<span class="command">wpscan --url https://example.com --debug</span>

<span class="command"># Log to file</span>
<span class="command">wpscan --url https://example.com --log results.log</span></pre>
            </div>

            <h3>Custom Report Generation</h3>
            <div class="code-block">
                <pre><span class="command"># Generate comprehensive report</span>
<span class="command">wpscan --url https://example.com \
  --enumerate ap,at,u,cb,dbe \
  --api-token YOUR_TOKEN \
  --format json \
  --output comprehensive_scan.json \
  --verbose</span></pre>
            </div>

            <h3>Sample JSON Output Structure</h3>
            <div class="code-block">
                <pre><span class="output">{
  "version": {
    "number": "6.3.1",
    "release_date": "2023-08-17",
    "status": "latest"
  },
  "main_theme": {
    "slug": "twentytwentythree",
    "location": "https://example.com/wp-content/themes/twentytwentythree/",
    "version": {
      "number": "1.1",
      "confidence": 80
    },
    "vulnerabilities": []
  },
  "plugins": {
    "contact-form-7": {
      "location": "https://example.com/wp-content/plugins/contact-form-7/",
      "version": {
        "number": "5.7.5",
        "confidence": 100
      },
      "vulnerabilities": [
        {
          "title": "Contact Form 7 < 5.7.6 - Stored XSS",
          "fixed_in": "5.7.6",
          "references": {
            "cve": ["CVE-2023-12345"],
            "url": ["https://wpscan.com/vulnerability/12345"]
          }
        }
      ]
    }
  },
  "users": [
    {
      "id": 1,
      "username": "admin",
      "found_by": "Author Posts - Display Name"
    }
  ]
}</span></pre>
            </div>
        </section>

        <section id="api-integration" class="section">
            <h2>API Integration and Automation</h2>

            <h3>WPScan API Token Setup</h3>
            <div class="code-block">
                <pre><span class="command"># Get free API token from https://wpscan.com/api</span>
<span class="command"># Free tier: 25 requests per day</span>
<span class="command"># Paid tiers: Up to 5000 requests per day</span>

<span class="command"># Configure API token globally</span>
<span class="command">wpscan --api-token YOUR_TOKEN --save-api-token</span>

<span class="command"># Verify API token status</span>
<span class="command">wpscan --api-token YOUR_TOKEN --status</span></pre>
            </div>

            <h3>Batch Scanning Script</h3>
            <div class="code-block">
                <pre><span class="command">#!/bin/bash
# batch_wpscan.sh - Scan multiple WordPress sites

SITES_FILE="wordpress_sites.txt"
OUTPUT_DIR="scan_results"
API_TOKEN="YOUR_API_TOKEN_HERE"

mkdir -p $OUTPUT_DIR

while IFS= read -r site; do
    if [[ $site =~ ^https?:// ]]; then
        echo "Scanning: $site"
        filename=$(echo $site | sed 's/https\?:\/\///g' | tr '/' '_')
        
        wpscan --url "$site" \
               --api-token "$API_TOKEN" \
               --enumerate ap,at,u \
               --format json \
               --output "$OUTPUT_DIR/${filename}_scan.json" \
               --random-user-agent \
               --throttle 1000
        
        echo "Completed: $site"
        sleep 5
    fi
done < "$SITES_FILE"</span></pre>
            </div>

            <h3>Python Integration Example</h3>
            <div class="code-block">
                <pre><span class="command">#!/usr/bin/env python3
import subprocess
import json
import sys
from datetime import datetime

def run_wpscan(target_url, api_token=None):
    """Run WPScan against target URL"""
    cmd = [
        'wpscan',
        '--url', target_url,
        '--enumerate', 'ap,at,u',
        '--format', 'json',
        '--random-user-agent'
    ]
    
    if api_token:
        cmd.extend(['--api-token', api_token])
    
    try:
        result = subprocess.run(cmd, capture_output=True, text=True, timeout=300)
        if result.returncode == 0:
            return json.loads(result.stdout)
        else:
            print(f"Error scanning {target_url}: {result.stderr}")
            return None
    except subprocess.TimeoutExpired:
        print(f"Timeout scanning {target_url}")
        return None
    except Exception as e:
        print(f"Exception scanning {target_url}: {e}")
        return None

def analyze_results(scan_data):
    """Analyze scan results for vulnerabilities"""
    if not scan_data:
        return
    
    vulnerabilities = []
    
    # Check WordPress core vulnerabilities
    if 'version' in scan_data and 'vulnerabilities' in scan_data['version']:
        vulnerabilities.extend(scan_data['version']['vulnerabilities'])
    
    # Check plugin vulnerabilities
    if 'plugins' in scan_data:
        for plugin_name, plugin_data in scan_data['plugins'].items():
            if 'vulnerabilities' in plugin_data:
                vulnerabilities.extend(plugin_data['vulnerabilities'])
    
    # Check theme vulnerabilities
    if 'themes' in scan_data:
        for theme_name, theme_data in scan_data['themes'].items():
            if 'vulnerabilities' in theme_data:
                vulnerabilities.extend(theme_data['vulnerabilities'])
    
    return vulnerabilities

if __name__ == "__main__":
    if len(sys.argv) < 2:
        print("Usage: python3 wpscan_automation.py <target_url> [api_token]")
        sys.exit(1)
    
    target = sys.argv[1]
    token = sys.argv[2] if len(sys.argv) > 2 else None
    
    print(f"Scanning {target} at {datetime.now()}")
    results = run_wpscan(target, token)
    
    if results:
        vulns = analyze_results(results)
        if vulns:
            print(f"Found {len(vulns)} vulnerabilities:")
            for vuln in vulns:
                print(f"- {vuln.get('title', 'Unknown vulnerability')}")
        else:
            print("No vulnerabilities found.")
    else:
        print("Scan failed or returned no results.")</span></pre>
            </div>

            <h3>Continuous Monitoring Setup</h3>
            <div class="code-block">
                <pre><span class="command"># Crontab entry for daily scans</span>
<span class="command"># Run daily at 2 AM</span>
<span class="command">0 2 * * * /usr/local/bin/wpscan --url https://example.com --api-token TOKEN --enumerate ap,at --format json --output /var/log/wpscan/daily_$(date +\%Y\%m\%d).json</span>

<span class="command"># Weekly comprehensive scan</span>
<span class="command">0 3 * * 0 /usr/local/bin/wpscan --url https://example.com --api-token TOKEN --enumerate ap,at,u,cb,dbe --format json --output /var/log/wpscan/weekly_$(date +\%Y\%m\%d).json</span></pre>
            </div>
        </section>

        <section id="troubleshooting" class="section">
            <h2>Troubleshooting Common Issues</h2>

            <h3>Connection Problems</h3>
            <div class="feature-grid">
                <div class="feature-card">
                    <h4>SSL Certificate Issues</h4>
                    <div class="code-block">
                        <pre><span class="command">wpscan --url https://example.com --disable-tls-checks</span></pre>
                    </div>
                </div>
                <div class="feature-card">
                    <h4>Timeout Problems</h4>
                    <div class="code-block">
                        <pre><span class="command">wpscan --url https://example.com --request-timeout 120</span></pre>
                    </div>
                </div>
                <div class="feature-card">
                    <h4>Rate Limiting</h4>
                    <div class="code-block">
                        <pre><span class="command">wpscan --url https://example.com --throttle 3000 --max-threads 1</span></pre>
                    </div>
                </div>
                <div class="feature-card">
                    <h4>User Agent Blocking</h4>
                    <div class="code-block">
                        <pre><span class="command">wpscan --url https://example.com --random-user-agent</span></pre>
                    </div>
                </div>
            </div>

            <h3>Detection Evasion</h3>
            <div class="code-block">
                <pre><span class="command"># Stealth scan configuration</span>
<span class="command">wpscan --url https://example.com \
  --random-user-agent \
  --throttle 5000 \
  --max-threads 1 \
  --request-timeout 60 \
  --detection-mode passive</span>

<span class="command"># Use proxy chain</span>
<span class="command">wpscan --url https://example.com \
  --proxy http://proxy1.example.com:8080 \
  --random-user-agent \
  --throttle 10000</span></pre>
            </div>

            <h3>Common Error Messages</h3>
            <table class="option-table">
                <thead>
                    <tr>
                        <th>Error</th>
                        <th>Cause</th>
                        <th>Solution</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>The remote website is up, but does not seem to be running WordPress.</td>
                        <td>Target is not WordPress or heavily customized</td>
                        <td>Use --force flag or verify target</td>
                    </tr>
                    <tr>
                        <td>API token limit reached</td>
                        <td>Daily API quota exceeded</td>
                        <td>Wait 24 hours or upgrade plan</td>
                    </tr>
                    <tr>
                        <td>Connection timeout</td>
                        <td>Network issues or server blocking</td>
                        <td>Increase timeout, use proxy, or throttle</td>
                    </tr>
                    <tr>
                        <td>403 Forbidden</td>
                        <td>Web Application Firewall blocking</td>
                        <td>Change user agent, use proxy, or reduce threads</td>
                    </tr>
                </tbody>
            </table>

            <h3>Debug and Logging</h3>
            <div class="code-block">
                <pre><span class="command"># Enable debug mode</span>
<span class="command">wpscan --url https://example.com --debug</span>

<span class="command"># Verbose output with logging</span>
<span class="command">wpscan --url https://example.com --verbose --log debug.log</span>

<span class="command"># Check WPScan configuration</span>
<span class="command">wpscan --help</span>
<span class="command">wpscan --version</span></pre>
            </div>

            <h3>Performance Optimization</h3>
            <div class="info">
                <strong>Performance Tips:</strong>
                <ul style="margin-top: 10px;">
                    <li>Use appropriate thread counts (5-20 for most cases)</li>
                    <li>Implement throttling for stable connections</li>
                    <li>Use passive detection mode for stealth</li>
                    <li>Cache DNS lookups for batch scans</li>
                    <li>Monitor bandwidth usage with large wordlists</li>
                </ul>
            </div>
        </section>

        <section id="best-practices" class="section">
            <h2>Security Best Practices</h2>

            <h3>Ethical Guidelines</h3>
            <div class="warning">
                <strong>⚠️ Important:</strong> Always follow these ethical guidelines:
                <ul style="margin-top: 10px;">
                    <li>Only scan websites you own or have explicit written permission to test</li>
                    <li>Respect rate limits and avoid overwhelming target servers</li>
                    <li>Don't attempt to exploit discovered vulnerabilities without permission</li>
                    <li>Report findings responsibly through proper channels</li>
                    <li>Comply with local laws and regulations</li>
                </ul>
            </div>

            <h3>Recommended Scan Configurations</h3>

            <h4>Basic Security Assessment</h4>
            <div class="code-block">
                <pre><span class="command">wpscan --url https://target.com \
  --api-token YOUR_TOKEN \
  --enumerate vp,vt \
  --random-user-agent \
  --throttle 1000</span></pre>
            </div>

            <h4>Comprehensive Audit</h4>
            <div class="code-block">
                <pre><span class="command">wpscan --url https://target.com \
  --api-token YOUR_TOKEN \
  --enumerate ap,at,u,cb,dbe \
  --detection-mode aggressive \
  --plugins-version-all \
  --format json \
  --output comprehensive_audit.json \
  --verbose</span></pre>
            </div>

            <h4>Stealth Reconnaissance</h4>
            <div class="code-block">
                <pre><span class="command">wpscan --url https://target.com \
  --detection-mode passive \
  --enumerate p,t \
  --random-user-agent \
  --throttle 5000 \
  --max-threads 1</span></pre>
            </div>

            <h3>Reporting and Documentation</h3>
            <div class="feature-grid">
                <div class="feature-card">
                    <h4>Vulnerability Assessment</h4>
                    <p>Document all discovered vulnerabilities with severity ratings, affected components, and recommended fixes.</p>
                </div>
                <div class="feature-card">
                    <h4>Risk Analysis</h4>
                    <p>Analyze the business impact of discovered issues and prioritize remediation efforts.</p>
                </div>
                <div class="feature-card">
                    <h4>Remediation Guidance</h4>
                    <p>Provide specific steps to address each vulnerability, including version updates and configuration changes.</p>
                </div>
                <div class="feature-card">
                    <h4>Follow-up Testing</h4>
                    <p>Schedule re-testing to verify that vulnerabilities have been properly addressed.</p>
                </div>
            </div>

            <h3>Integration with Security Workflow</h3>
            <div class="code-block">
                <pre><span class="command"># Pre-deployment security check</span>
<span class="command">wpscan --url https://staging.example.com \
  --api-token YOUR_TOKEN \
  --enumerate ap,at \
  --format json | \
  jq '.plugins[] | select(.vulnerabilities | length > 0)'</span>

<span class="command"># Automated vulnerability monitoring</span>
<span class="command">#!/bin/bash
SCAN_RESULT=$(wpscan --url https://example.com --api-token TOKEN --format json --enumerate vp,vt)
VULN_COUNT=$(echo $SCAN_RESULT | jq '[.plugins[]?.vulnerabilities[]?, .themes[]?.vulnerabilities[]?] | length')

if [ "$VULN_COUNT" -gt 0 ]; then
    echo "ALERT: $VULN_COUNT vulnerabilities found!"
    # Send notification (email, Slack, etc.)
    echo $SCAN_RESULT | mail -s "WordPress Security Alert" admin@example.com
fi</span></pre>
            </div>

            <h3>Security Hardening Recommendations</h3>
            <div class="success">
                <strong>Based on WPScan findings, implement these security measures:</strong>
                <ul style="margin-top: 10px;">
                    <li>Keep WordPress core, themes, and plugins updated</li>
                    <li>Remove unused themes and plugins</li>
                    <li>Implement strong authentication (2FA)</li>
                    <li>Use security plugins (Wordfence, Sucuri)</li>
                    <li>Configure Web Application Firewall (WAF)</li>
                    <li>Regular security monitoring and scanning</li>
                    <li>Backup and disaster recovery procedures</li>
                    <li>Limit login attempts and user enumeration</li>
                </ul>
            </div>

            <h3>Advanced Detection Bypass</h3>
            <div class="code-block">
                <pre><span class="command"># Rotate user agents from file</span>
<span class="command">wpscan --url https://example.com --user-agents-list user_agents.txt</span>

<span class="command"># Custom headers to bypass WAF</span>
<span class="command">wpscan --url https://example.com \
  --headers "X-Forwarded-For: 192.168.1.1" \
  --headers "X-Real-IP: 10.0.0.1" \
  --random-user-agent</span>

<span class="command"># Distributed scanning through proxies</span>
<span class="command">for proxy in $(cat proxy_list.txt); do
  wpscan --url https://example.com \
    --proxy $proxy \
    --enumerate u1-10 \
    --throttle 10000
  sleep 60
done</span></pre>
            </div>
        </section>

        <footer style="text-align: center; margin-top: 50px; padding: 30px; background: #1a1a1a; border-radius: 10px; border: 1px solid #333;">
            <h3 style="color: #fff; margin-bottom: 15px;">WPSCAN Complete Walkthrough</h3>
            <p style="color: #aaa;">This comprehensive guide covers all aspects of WordPress security scanning with WPScan.</p>
            <p style="color: #888; font-size: 0.9em; margin-top: 15px;">Remember: Always use WPScan responsibly and ethically. Only scan websites you own or have explicit permission to test.</p>
            <div style="margin-top: 20px;">
                <span style="color: #666;">Version 1.0 | Created for educational and authorized testing purposes</span>
            </div>
        </footer>

        <button class="scroll-top" onclick="window.scrollTo(0,0)" id="scrollTop">↑</button>
    </div>

    <script>
        // Show scroll to top button
        window.onscroll = function() {
            const scrollTop = document.getElementById('scrollTop');
            if (document.body.scrollTop > 20 || document.documentElement.scrollTop > 20) {
                scrollTop.style.display = "block";
            } else {
                scrollTop.style.display = "none";
            }
        };

        // Smooth scrolling for navigation links
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            });
        });

        // Add hover effects to code blocks
        document.querySelectorAll('.code-block').forEach(block => {
            block.addEventListener('mouseenter', function() {
                this.style.transform = 'scale(1.02)';
                this.style.transition = 'transform 0.2s ease';
            });
            
            block.addEventListener('mouseleave', function() {
                this.style.transform = 'scale(1)';
            });
        });

        // Terminal typing effect for examples
        function typeWriter(element, text, speed = 50) {
            let i = 0;
            element.innerHTML = 'terminal@wpscan:~$ ';
            
            function type() {
                if (i < text.length) {
                    element.innerHTML += text.charAt(i);
                    i++;
                    setTimeout(type, speed);
                }
            }
            type();
        }

        // Initialize typing effects on scroll
        const terminals = document.querySelectorAll('.terminal');
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting && !entry.target.dataset.typed) {
                    const text = entry.target.textContent.replace('terminal@wpscan:~$ ', '');
                    entry.target.dataset.typed = 'true';
                    typeWriter(entry.target, text);
                }
            });
        });

        terminals.forEach(terminal => {
            observer.observe(terminal);
        });

        console.log(`
██╗    ██╗██████╗ ███████╗ ██████╗ █████╗ ███╗   ██╗
██║    ██║██╔══██╗██╔════╝██╔════╝██╔══██╗████╗  ██║
██║ █╗ ██║██████╔╝███████╗██║     ███████║██╔██╗ ██║
██║███╗██║██╔═══╝ ╚════██║██║     ██╔══██║██║╚██╗██║
╚███╔███╔╝██║     ███████║╚██████╗██║  ██║██║ ╚████║
 ╚══╝╚══╝ ╚═╝     ╚══════╝ ╚═════╝╚═╝  ╚═╝╚═╝  ╚═══╝

Complete WordPress Security Scanner Walkthrough
Use responsibly and ethically!
        `);
    </script>
</body>
</html>